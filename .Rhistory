par(mar=c(2, 1, 0, 0))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
plot.new()
dev.off()
layout(rbind(1,2), heights=c(7,1))
par(mar=c(4, 1, 0, 0))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
plot.new()
legend('center','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(4, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
legend('center','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(4, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
par(oma = c(2, 1, 1, 1))
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 0, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
plot.new()
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
?layout
dev.off()
layout(rbind(1,2), heights=c(7,1))
plot(gom_months)
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
dev.off()
layout(rbind(1,2), heights=c(7,1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(mar=c(0, 0, 0, 0))
plot.new()
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
dev.off()
layout(rbind(1,2), heights=c(9,1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(mar=c(0, 0, 0, 0))
plot.new()
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
layout(rbind(1,2), heights=c(9,1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(mar=c(0, 0, 0, 0))
plot.new()
legend('bottom','groups',c("Seasonal Naive","STL","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
### legend
dev.off()
layout(rbind(1,2), heights=c(9,1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(mar=c(0, 0, 0, 0))
plot.new()
legend('bottom','groups',c("Seasonal & Trend Decomposition","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
dev.off()
layout(rbind(1,2), heights=c(9,1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(mar=c(0, 0, 0, 0))
plot.new()
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
par(oma = c(2, 1, 1, 1))
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),14)
monthdays[26 + (4*12)*(0:2)] <- 29
View(monthdays)
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),5)
monthdays[26 + (4*12)*(0:2)] <- 29
View(monthdays)
rm(monthdays)
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),5)
View(monthdays)
View(gom_months)
monthdays <- monthdays[-60:55]
monthdays <- monthdays[-60]
View(monthdays)
monthdays <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),5)
monthdays <- monthdays[-55:-60]
View(monthdays)
gom_months2 <- gom_months/monthdays
View(gom_months2)
ggplot(data = gom_months2, aes(x = date, y = counts)) + geom_line()
gom_months2 <- gom_months/monthdays
View(gom_months2)
gom_months <- gom_months/monthdays
View(gom_months)
counts <- gom_months$counts
# create ts for data from 2010 - 2014
gom_months <- ts(counts, start = c(2010, 1), end = c(2014, 6), frequency = 12)
# subset ts from 2010 - 2012 to create training data
gom_train <- window(gom_months, start = c(2010, 1), end = c(2012, 12))
gom_test <- window(gom_months, start = c(2013, 1), end = c(2014, 6))
### forecast with mean, naive, and seasonal naive models
# mean model
gom_mean <- meanf(gom_train, h = 18)
# naive model
gom_naive <- naive(gom_train, h = 18)
# seasonal naive model
gom_sn <- snaive(gom_train, h = 18)
### plots of actual data and models
plot(gom_months)
lines(gom_mean$mean, col = 2, lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 4, lwd = 2)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
legend("topleft",lty=1, lwd = 2 ,col=c(2,3,4), legend=c("Mean method","Naive method","Seasonal naive method"))
plot(gom_months)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
View(gom_months)
View(gom_months)
gom_months <- gom_months/monthdays
View(gom_months)
counts <- gom_months
View(counts)
gom_months <- ts(counts, start = c(2010, 1), end = c(2014, 6), frequency = 12)
View(gom_months)
# subset ts from 2010 - 2012 to create training data
gom_train <- window(gom_months, start = c(2010, 1), end = c(2012, 12))
gom_test <- window(gom_months, start = c(2013, 1), end = c(2014, 6))
### forecast with mean, naive, and seasonal naive models
# mean model
gom_mean <- meanf(gom_train, h = 18)
# naive model
gom_naive <- naive(gom_train, h = 18)
# seasonal naive model
gom_sn <- snaive(gom_train, h = 18)
### plots of actual data and models
plot(gom_months)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
legend("topleft",lty=1, lwd = 2 ,col=c(2,3,4), legend=c("Mean method","Naive method","Seasonal naive method"))
### seasonal decomposition
gom_stl <- stl(gom_months, s.window = 'periodic', t.window = 12, robust = T)
plot(gom_stl)
gom_stltrain <- stl(gom_train, s.window = 'periodic', t.window = 12, robust = T)
plot(gom_stltrain)
gom_stlf <- forecast(gom_stltrain, method = 'naive', h = 18)
# plot actual data and add forecast
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
# plot forecast and add test data
plot(gom_stlf)
lines(gom_test, col = 'red')
### holt-winters
gom_hwf <- hw(gom_train, seasonal = 'multiplicative', damped = T, initial = 'optimal', h = 18)
lines(gom_hwf$mean, col = 'green', lwd = 2)
gom_arima <- auto.arima(gom_train, stepwise = F, approximation = F)
gom_arimaf <- forecast(gom_arima, h = 18)
lines(gom_arimafore$mean, col = 'purple', lwd = 2)
summary(gom_arima)
# regression
gom_reg <- tslm(gom_train ~ trend + season)
summary(gom_reg)
gom_regf <- forecast(gom_reg, h = 18)
lines(gom_regf$mean, col = 'blue', lwd = 2)
legend("topleft",lty=1, lwd = 2 ,col=c(2,3,4), legend=c("Mean method","Naive method","Seasonal naive method"))
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c("STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('red', 'green', 'blue'), ncol = 3, bty = 'n')
plot(gom_hwf)
plot(gom_hwf)
plot(gom_arimaf)
plot(gom_regf)
?tslm
plot(gom_sn)
lines(gom_test, lwd = 2, col = 'red')
legend("bottom",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Seasonal Naive Forecast","Actual Counts"))
plot(gom_sn, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Seasonal Naive Forecast","Actual Counts"))
gom_stl <- stl(gom_months, s.window = 'periodic', t.window = 12, robust = T)
plot(gom_stl)
monthplot(gom_months)
?seasonplot
seasonplot(gom_months, year.labels.left = T)
monthplot(gom_months, xlab = 'Months', ylab = 'Average No. of Reqs / Month', main = 'Average No. of Reqs in each month')
seasonplot(gom_months, year.labels.left = T, xlab = 'Time', ylab = 'Average No. of Reqs / Month', 'Seasonality of Average No. of Reqs in each year')
seasonplot(gom_months, year.labels.left = T, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Seasonality of Average No. of Reqs in each year')
plot(gom_stlf, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("STL Forecast","Actual Counts"))
plot(gom_hwf, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Holt-Winters Forecast","Actual Counts"))
plot(gom_regf, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Regression Forecast","Actual Counts"))
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('purple','red', 'green', 'blue'), ncol = 2, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('purple','red', 'green', 'blue'), ncol = 4, bty = 'n')
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('purple','red', 'green', 'blue'), ncol = 4, bty = 'n')
accuracy
?accuracy
accuracy(gom_sn, gom_test)
accuracy(gom_stlf, gom_test)
accuracy(gom_hwf, gom_test)
accuracy(gom_regf, gom_test)
accuracy(gom_sn, gom_test)[1, 'MASE']
accuracy(gom_stlf, gom_test)
accuracy(gom_sn, gom_test)[2, 'MASE']
accuracy(gom_stlf, gom_test)[2, 'MASE']
accuracy(gom_hwf, gom_test)[2, 'MASE']
accuracy(gom_regf, gom_test)[2, 'MASE']
accuracy(gom_sn, gom_test)[, 'MASE']
accuracy(gom_stlf, gom_test)[, 'MASE']
accuracy(gom_hwf, gom_test)[, 'MASE']
accuracy(gom_regf, gom_test)[, 'MASE']
accuracy(gom_sn, gom_test)[, 'RMSE']
accuracy(gom_stlf, gom_test)[, 'RMSE']
accuracy(gom_hwf, gom_test)[, 'RMSE']
accuracy(gom_regf, gom_test)[, 'RMSE']
beer2 <- window(ausbeer,start=1992,end=2006-.1)
beerfit1 <- meanf(beer2,h=11)
beerfit2 <- rwf(beer2,h=11)
beerfit3 <- snaive(beer2,h=11)
plot(beerfit1, plot.conf=FALSE,
main="Forecasts for quarterly beer production")
lines(beerfit2$mean,col=2)
lines(beerfit3$mean,col=3)
lines(ausbeer)
legend("topright", lty=1, col=c(4,2,3),
legend=c("Mean method","Naive method","Seasonal naive method"))
beer3 <- window(ausbeer, start=2006)
accuracy(beerfit1, beer3)
accuracy(beerfit2, beer3)
accuracy(beerfit3, beer3)
accuracy(gom_sn, gom_test)[, 'MASE']
accuracy(gom_stlf, gom_test)[, 'MASE']
accuracy(gom_hwf, gom_test)[, 'MASE']
accuracy(gom_regf, gom_test)[, 'MASE']
summary(gom_reg)
gom_hwf2 <- hw(gom_train, seasonal = 'additive', damped = T, initial = 'optimal', h = 18)
accuracy(gom_hwf, gom_test)[, 'MASE']
accuracy(gom_hwf2, gom_test)
accuracy(gom_hwf2, gom_test)[, 'MASE']
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf2$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('purple','red', 'green', 'blue'), ncol = 4, bty = 'n')
plot(gom_hwf2, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Holt-Winters Forecast","Actual Counts"))
### arima
dev.off()
plot(gom_hwf2, xlab = 'Time', ylab = 'Average No. of Reqs / Month')
lines(gom_test, lwd = 2, col = 'red')
legend("topleft",lty=1, lwd = 2 ,col=c('blue', 'red'), legend=c("Holt-Winters Forecast","Actual Counts"))
?stl
summary(gom_stlf)
summary(stl)
summary(gom_stltrain)
plot(gom_stltrain)
gom_stl <- stl(gom_months, s.window = 'periodic', t.window = 12, robust = T)
plot(gom_stl)
summary(gom_stl)
summary(gom_stltrain)
plot(gom_stltrain)
plot(gom_stl)
summary(gom_stl)
plot(gom_stltrain)
summary(gom_stltrain)
seasonal <- gom_stl$time.series[,1]
trend <- gom_stl$time.series[,2]
remainder <- gom_stl$time.series[,3]
plot(trend+remainder)
plot(trend+remainder+ seasonal)
plot(trend)
plot(trend+remainder)
plot(trend)
plot(seasonal)
plot(trend+remainder)
plot(remainder)
plot(trend+remainder, xlab = 'Average No. of Reqs / Month', main = 'De-seasonalized Trend + Remainder')
plot(trend+remainder, ylab = 'Average No. of Reqs / Month', main = 'De-seasonalized Trend + Remainder')
plot(trend+remainder, ylab = 'Average No. of Reqs / Month', main = 'Seasonally Adjusted Average No. of Reqs / Month')
View(gom_months)
str(gom_months)
gom_months_excel <- c(4420, 4507, 4560, 4651, 4703, 4601, 4486, 4455, 4371, 4351, 4358, 4284, 4194, 4211, 4240, 4321, 4369, 4430)
gom_months_excel <- gom_months_excel/monthdays
View(gom_months_excel)
gom_months_excel <- ts(gom_months_excel, start = c(2013, 1), end = c(2014, 6))
plot(gom_months)
lines(gom_months_excel, col = 'blue', lwd = 2)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_months_excel, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
View(gom_months_excel)
gom_months_excel <- c(4420, 4507, 4560, 4651, 4703, 4601, 4486, 4455, 4371, 4351, 4358, 4284, 4194, 4211, 4240, 4321, 4369, 4430)
gom_months_excel <- gom_months_excel/monthdays
monthdays_excel <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),2)
View(monthdays_excel)
monthdays <- monthdays[-19:-24]
monthdays_excel <- monthdays_excel[-19:-24]
gom_months_excel <- c(4420, 4507, 4560, 4651, 4703, 4601, 4486, 4455, 4371, 4351, 4358, 4284, 4194, 4211, 4240, 4321, 4369, 4430)
gom_months_excel <- gom_months_excel/monthdays_excel
plot(gom_months)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_months_excel, col = 'blue', lwd = 2)
lines(gom_months_excel, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
View(gom_months_excel)
gom_months_excel <- ts(gom_months_excel, start = c(2013, 1), end = c(2014, 6))
gom_months_excel <- c(4420, 4507, 4560, 4651, 4703, 4601, 4486, 4455, 4371, 4351, 4358, 4284, 4194, 4211, 4240, 4321, 4369, 4430)
monthdays_excel <- rep(c(31,28,31,30,31,30,31,31,30,31,30,31),2)
monthdays_excel <- monthdays_excel[-19:-24]
gom_months_excel <- gom_months_excel/monthdays_excel
gom_months_excel <- ts(gom_months_excel, start = c(2013, 1), end = c(2014, 6), frequency = 12)
plot(gom_months)
lines(gom_mean$mean, col = 'blue', lwd = 2)
lines(gom_months_excel, col = 'blue', lwd = 2)
lines(gom_naive$mean, col = 'red', lwd = 2)
lines(gom_sn$mean, col = 'green', lwd = 2)
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_months_excel, col = 'grey', lwd = 2)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf2$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Excel', 'Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('grey', 'purple','red', 'green', 'blue'), ncol = 5, bty = 'n')
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_months_excel, col = 'grey', lwd = 2)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf2$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Excel', 'Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('grey', 'purple','red', 'green', 'blue'), ncol = 3, bty = 'n')
View(gom_months_excel)
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_months_excel, col = 'orange', lwd = 2)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf2$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Excel', 'Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('orange', 'purple','red', 'green', 'blue'), ncol = 3, bty = 'n')
accuracy(gom_months_excel, gom_test)
library(fpp)
accuracy(gom_months_excel, gom_test)
accuracy(gom_sn, gom_test)[, 'RMSE']
accuracy(gom_stlf, gom_test)[, 'RMSE']
accuracy(gom_hwf, gom_test)[, 'RMSE']
accuracy(gom_regf, gom_test)[, 'RMSE']
dev.off()
par(oma = c(2, 1, 1, 1))
plot(gom_months, xlab = 'Time', ylab = 'Average No. of Reqs / Month', main = 'Comparison of Forecasts to actual data')
lines(gom_months_excel, col = 'orange', lwd = 2)
lines(gom_sn$mean, col = 'purple', lwd = 2)
lines(gom_stlf$mean, col = 'red', lwd = 2)
lines(gom_hwf2$mean, col = 'green', lwd = 2)
lines(gom_regf$mean, col = 'blue', lwd = 2)
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom','groups',c('Linear Regression', 'Seasonal Naive', "STL","Holt-Winters","Regression"), lty = 1, lwd = 2, col = c('orange', 'purple','red', 'green', 'blue'), ncol = 3, bty = 'n')
### checking accuracy
accuracy(gom_hwf, gom_test)[, 'RMSE']
accuracy(gom_hwf2, gom_test)[, 'RMSE']
plot(gom_months, col = 'grey', ylab = 'Average No. of Reqs / Month', main = 'Seasonally Adjusted Average No. of Reqs / Month')
lines(seasadj(gom_stl),col="red",ylab="Seasonally adjusted")
dev.off()
plot(gom_months, col = 'grey', ylab = 'Average No. of Reqs / Month', main = 'Seasonally Adjusted Average No. of Reqs / Month')
lines(seasadj(gom_stl),col="red",ylab="Seasonally adjusted")
legend("topleft",lty=1, lwd = 2 ,col=c('grey', 'red'), legend=c("Original data","Seasonally-adjusted data"))
